---
title: "NCAA Football Analysis"
author: "Junyu Chen, Max Waun"
date: "4/4/2020"
output:
  html_document:
    df_print: paged
    number_sections: yes
    self_contained: no
    theme: cerulean
    toc: yes
    toc_float: yes
  word_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      message = FALSE, 
                      warning = FALSE,
                      comment = NA)
```

# Introduction and Methods
## Description of the dataset

  
## Questions


## Methods
In order to accomplish this, the methods we will use are:

- Both the dplyr and tidyverse libraries, including ggplot(), select(), mutate()

- `Simple linear regression`:
    
    For question 1: Since we want to determine defense really win championships or not, then we will show the relationship between defense and win percentage and the relationship between offense and win percentage and observe which one is stronger. Assume there is a linear relationship exists between a predictor defense/offense and response win percentage. 
    
- `Multiple regression`


```{r}
library(dplyr)
library(tidyr)
library(ggplot2)
library(gridExtra)
library(ggExtra)
library(WVPlots)

CFB<-read.csv("CFB2019.csv")
CFB<-CFB %>%
  separate(Win.Loss, c("Win", "Loss"), "-") %>%
  mutate(Winpct = as.numeric(Win)/Games,Avg.Rank=(Off.Rank+Def.Rank)/2)
```

# Results

## Does defense really win championships?
### Result of simple linear regression

  We determined defense really win championships or not by showing the relationship between defense and win percentage and the relationship between offense and win percentage, observe which one is stronger. We use `simple linear regression` to do it and assume there is a linear relationship exists between a predictor defense/offense and response win percentage. 

```{r}
lm(Winpct~Off.Rank,data = CFB)
lm(Winpct~Def.Rank,data = CFB)
```

Base on the function `lm()`, we can find the relation between Winpct and offence is Winpct = 0.730568 - 0.003184 * Off.Rank; the relation between Winpct and defense is Winpct = 0.767201 - 0.003743 * Off.Rank.

### Result of the graphs
```{r}
ScatterHist(CFB, "Off.Rank", "Winpct",
            smoothmethod="lm",
            title="Win Percentage vs. Offensive Rank")

ScatterHist(CFB, "Def.Rank", "Winpct",
            smoothmethod="lm",
            title="Win Percentage vs. Defensive Rank")
```





## Are special teams of particular value for a team’s performance?
### Result of Multiple regression

 Since winpct has many predictors which relate to the special team, then we use `Multiple regression` to find which special teams of particular value for a team’s performance.
 
  First, we create a full model which contain all predictors and find which predictors have significance star will inference winpct;
  
```{r}
#creat a full model which contains all feacture related to special teams 
full.model<-lm(Winpct~Kickoff.Return.Rank + 
                 Kickoffs.Returned +
                 Kickoff.Return.Touchdowns +
                 Avg.Yard.per.Kickoff.Return +
                 Punt.Return.Rank+ 
                 Redzone.Field.Goals.Made,data = CFB)
summary(full.model)
```

  We can see that only the predictor Kickoffs.Returned and Redzone.Field.Goals.Made has the significance star which will inference winpct.
  
  Base on above result, create another model which only include the predictor Kickoffs.Returned and Redzone.Field.Goals.Made;
  
```{r}
full.model.1<-lm(Winpct~ 
                 Kickoffs.Returned +
                 Redzone.Field.Goals.Made,data = CFB)
full.model.1
```
  
  We can find that Winpct = 0.547174 - 0.005904 * Kickoffs.Returned + 0.013440 * Redzone.Field.Goals.Made.
  
### Result of the graphs
```{r}
CFB %>%ggplot(aes(Redzone.Field.Goals.Made,Winpct))+geom_point(aes(color=Kickoffs.Returned,size=Kickoffs.Returned))+stat_smooth(method = lm)+labs(title = "Redzone.Field.Goals.Made vs. Win percent")+ylab("Win percent")
```






## What’s the correlation between offensive and defensive performance?
### Result of simple linear regression

Assume there is a linear relationship exists between a predictor offense and response defense. 

```{r}
lm(Def.Rank~Off.Rank,data = CFB)
```

Base on the function `lm()`, we can find the relation between Winpct and offence is Winpct =  62.51343 + 0.04548 * Off.Rank;

### Result of correlation test

```{r}
cor.test(CFB$Off.Rank,CFB$Def.Rank)
```

Form `cor.test(Off.Rank,Def.Rank)` function we can get the correlation between offensive and defensive is 0.04547697 which is too small and the p-value = 0.6074 is to large. Then we know that there is no correlation between offensive and defensive performance

### Result of the graphs
```{r}
CFB %>% ggplot(aes(Off.Rank,Def.Rank)) +geom_point()+stat_smooth(method = lm)+labs(title = "Defensive Rank vs. Offensive Rank")
```

  

# Conclusion





# Reference

1. https://www.kaggle.com/jeffgallini/college-football-team-stats-2019
2. https://www.kaggle.com/johnluke999/a-look-inside-the-college-football-season